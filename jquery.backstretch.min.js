;(function($){$.backstretch=function(src,options,callback){var defaultSettings={centeredX:true,centeredY:true,speed:0},$container=$("#backstretch"),settings=$container.data("settings")||defaultSettings,existingSettings=$container.data('settings'),rootElement,supportsFixedPosition,useWindowInnerHeight,imgRatio,bgImg,bgWidth,bgHeight,bgOffset,bgCSS;if(options&&typeof options=="object")$.extend(settings,options);if(options&&typeof options=="function")callback=options;$(document).ready(function(){var w=window,ua=navigator.userAgent,platform=navigator.platform,wkmatch=ua.match(/AppleWebKit\/([0-9]+)/),wkversion=!!wkmatch&&wkmatch[1],ffmatch=ua.match(/Fennec\/([0-9]+)/),ffversion=!!ffmatch&&ffmatch[1],operammobilematch=ua.match(/Opera Mobi\/([0-9]+)/),omversion=!!operammobilematch&&operammobilematch[1],iematch=ua.match(/MSIE ([0-9]+)/),ieversion=!!iematch&&iematch[1];supportsFixedPosition=!(((platform.indexOf("iPhone")>-1||platform.indexOf("iPad")>-1||platform.indexOf("iPod")>-1)&&wkversion&&wkversion<534)||(w.operamini&&({}).toString.call(w.operamini)==="[object OperaMini]")||(operammobilematch&&omversion<7458)||(ua.indexOf("Android")>-1&&wkversion&&wkversion<533)||(ffversion&&ffversion<6)||("palmGetResource"in window&&wkversion&&wkversion<534)||(ua.indexOf("MeeGo")>-1&&ua.indexOf("NokiaBrowser/8.5.0")>-1)||(ieversion&&ieversion<=6));rootElement=supportsFixedPosition?$(window):$(document);useWindowInnerHeight=supportsFixedPosition&&window.innerHeight;_init();});return this;function _init(){if(src){var img;if($container.length==0){$container=$("<div />").attr("id","backstretch").css({left:0,top:0,position:supportsFixedPosition?"fixed":"absolute",overflow:"hidden",zIndex:-999999,margin:0,padding:0,height:"100%",width:"100%"});}else{$container.find("img").addClass("deleteable");}
img=$("<img />").css({position:"absolute",display:"none",margin:0,padding:0,border:"none",zIndex:-999999,maxWidth:"none"}).bind("load",function(e){var $self=$(this),imgWidth,imgHeight;$self.css({width:"auto",height:"auto"});imgWidth=this.width||$(e.target).width();imgHeight=this.height||$(e.target).height();imgRatio=imgWidth/imgHeight;_adjustBG();$self.fadeIn(settings.speed,function(){$container.find('.deleteable').remove();if(typeof callback=="function")callback();});}).appendTo($container);if($("body #backstretch").length==0){if($(window).scrollTop()===0)window.scrollTo(0,0);$("body").append($container);}
$container.data("settings",settings);img.attr("src",src);$(window).unbind("resize.backstretch").bind("resize.backstretch",function(){if("onorientationchange"in window){if(window.pageYOffset===0)window.scrollTo(0,1);}
_adjustBG()});}}
function _adjustBG(){try{bgCSS={left:0,top:0},rootWidth=bgWidth=rootElement.width(),rootHeight=useWindowInnerHeight?window.innerHeight:rootElement.height(),bgHeight=bgWidth/imgRatio;if(bgHeight>=rootHeight){bgOffset=(bgHeight-rootHeight)/2;if(settings.centeredY)bgCSS.top="-"+bgOffset+"px";}else{bgHeight=rootHeight;bgWidth=bgHeight*imgRatio;bgOffset=(bgWidth-rootWidth)/2;if(settings.centeredX)bgCSS.left="-"+bgOffset+"px";}
$container.css({width:rootWidth,height:rootHeight}).find("img:not(.deleteable)").css({width:bgWidth,height:bgHeight}).css(bgCSS);$(window).trigger("backstretch_update",{rootWidth:rootWidth,rootHeight:rootHeight,imgWidth:bgWidth,imgHeight:bgHeight,imgTop:bgCSS.top,imgLeft:bgCSS.left});}catch(err){}}};})(jQuery);